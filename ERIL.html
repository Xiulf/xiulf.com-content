<!DOCTYPE html>
<html lang="en">
    <head>
        <title>ERIL</title>
        <meta charset="utf-8">
        <link rel="shortcut icon" type="image/svg+xml" href="./img/favicon.svg">
        <link rel="stylesheet" href="./css/base.css">
        <link rel="stylesheet" href="./css/sidebar.css">
        <link rel="stylesheet" href="./css/footer.css">
        <link rel="stylesheet" href="./css/code.css">
        <script type="text/javascript" src="./js/links.js"></script>
        <script type="text/javascript" src="./js/sections.js"></script>
        <script type="text/javascript" src="./js/hl.js"></script>
    </head>
<body><nav id="sidebar"><a href="/" class="logo"><svg xmlns="http://www.w3.org/2000/svg" width="40px" height="40px" viewBox="0 0 2000 2000"><path fill="currentColor" d="M562.53,1795a65.64,65.64,0,0,1-46.45-112h0a1041.72,1041.72,0,0,0,73.42-83.74c39.08-50.06,53.36-80.1,58.58-95.45-3.44-.32-7.65-.53-12.76-.53-62.41,0-116.49-13.71-160.73-40.75-37.69-23-67.58-55.17-88.81-95.52-22.51-42.77-34.91-95.39-34.91-148.18s12.4-105.42,34.91-148.18c21.23-40.35,51.12-72.49,88.81-95.53,44.24-27,98.32-40.74,160.73-40.74H788.49V854.13c0-6.59.9-163.18,79.86-321.1,74.82-149.65,234.32-328,569.26-328A65.64,65.64,0,0,1,1484,317.06a1043.37,1043.37,0,0,0-73.44,83.71c-39.08,50-53.39,80.08-58.63,95.44,3.43.32,7.63.53,12.72.53,62.41,0,116.49,13.71,160.73,40.75,37.7,23,67.58,55.17,88.81,95.52,22.51,42.77,34.91,95.39,34.91,148.18s-12.4,105.42-34.91,148.18c-21.23,40.35-51.11,72.49-88.81,95.53-44.24,27-98.32,40.74-160.73,40.74H1211.51v80.23c0,6.57-.86,163.17-79.78,321.09C1056.94,1616.61,897.48,1795,562.53,1795Zm72.79-729.36c-66.32,0-110,21.63-133.37,66.13-12.58,23.91-19.79,55.63-19.79,87s7.21,63.13,19.79,87C525.37,1350.34,569,1372,635.32,1372c31.9,0,58.08,4.85,80,14.81,27.35,12.42,47.52,32.75,58.31,58.79,8.48,20.47,10.77,43.51,6.81,68.47-2.81,17.71-8.64,36.17-17.83,56.43-10.41,23-25.35,48.33-44.53,75.68,134.31-33.05,233.6-112.67,296.17-237.88,65.22-130.5,65.94-261.08,65.94-262.38V1000a65.64,65.64,0,0,1,65.64-65.64h218.81c66.32,0,110-21.63,133.37-66.13,12.58-23.91,19.79-55.63,19.79-87s-7.21-63.13-19.79-87c-23.42-44.5-67-66.13-133.37-66.13-31.89,0-58.07-4.85-80-14.81-27.36-12.42-47.52-32.75-58.31-58.79-8.48-20.47-10.77-43.51-6.8-68.48,2.82-17.71,8.66-36.17,17.86-56.43,10.42-22.95,25.36-48.31,44.54-75.66-134.28,33.07-233.57,112.68-296.17,237.88-65.25,130.5-66,261.08-66,262.39V1000a65.64,65.64,0,0,1-65.64,65.64Zm25.8,440.7Z"></path><path fill="currentColor" d="M899.25,1270.64a102.87,102.87,0,0,1-88.09-155.76l201.3-335.56a102.84,102.84,0,0,1,176.38,105.8l-201.3,335.56A102.8,102.8,0,0,1,899.25,1270.64Z"></path></svg></a><ul><li class=""><a href="/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M575.8 255.5C575.8 273.5 560.8 287.6 543.8 287.6H511.8L512.5 447.7C512.5 450.5 512.3 453.1 512 455.8V472C512 494.1 494.1 512 472 512H456C454.9 512 453.8 511.1 452.7 511.9C451.3 511.1 449.9 512 448.5 512H392C369.9 512 352 494.1 352 472V384C352 366.3 337.7 352 320 352H256C238.3 352 224 366.3 224 384V472C224 494.1 206.1 512 184 512H128.1C126.6 512 125.1 511.9 123.6 511.8C122.4 511.9 121.2 512 120 512H104C81.91 512 64 494.1 64 472V360C64 359.1 64.03 358.1 64.09 357.2V287.6H32.05C14.02 287.6 0 273.5 0 255.5C0 246.5 3.004 238.5 10.01 231.5L266.4 8.016C273.4 1.002 281.4 0 288.4 0C295.4 0 303.4 2.004 309.5 7.014L564.8 231.5C572.8 238.5 576.9 246.5 575.8 255.5L575.8 255.5z"></svg>Home</a></li><li class=""><a href="/projects"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M414.8 40.79L286.8 488.8C281.9 505.8 264.2 515.6 247.2 510.8C230.2 505.9 220.4 488.2 225.2 471.2L353.2 23.21C358.1 6.216 375.8-3.624 392.8 1.232C409.8 6.087 419.6 23.8 414.8 40.79H414.8zM518.6 121.4L630.6 233.4C643.1 245.9 643.1 266.1 630.6 278.6L518.6 390.6C506.1 403.1 485.9 403.1 473.4 390.6C460.9 378.1 460.9 357.9 473.4 345.4L562.7 256L473.4 166.6C460.9 154.1 460.9 133.9 473.4 121.4C485.9 108.9 506.1 108.9 518.6 121.4V121.4zM166.6 166.6L77.25 256L166.6 345.4C179.1 357.9 179.1 378.1 166.6 390.6C154.1 403.1 133.9 403.1 121.4 390.6L9.372 278.6C-3.124 266.1-3.124 245.9 9.372 233.4L121.4 121.4C133.9 108.9 154.1 108.9 166.6 121.4C179.1 133.9 179.1 154.1 166.6 166.6V166.6z"></svg>Projects</a></li><li class=""><a href="/blog"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M492.7 58.75C517.7 83.74 517.7 124.3 492.7 149.3L440.6 201.4L310.6 71.43L362.7 19.32C387.7-5.678 428.3-5.678 453.3 19.32L492.7 58.75zM240.1 114.9C231.6 105.5 216.4 105.5 207 114.9L104.1 216.1C95.6 226.3 80.4 226.3 71.03 216.1C61.66 207.6 61.66 192.4 71.03 183L173.1 80.97C201.2 52.85 246.8 52.85 274.9 80.97L417.9 224L229.5 412.5C181.5 460.5 120.3 493.2 53.7 506.5L28.71 511.5C20.84 513.1 12.7 510.6 7.03 504.1C1.356 499.3-1.107 491.2 .4662 483.3L5.465 458.3C18.78 391.7 51.52 330.5 99.54 282.5L254.1 128L240.1 114.9z"></svg>Blog</a></li><li class=""><a href="/art"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M224 263.3C224.2 233.3 238.4 205.2 262.4 187.2L499.1 9.605C517.7-4.353 543.6-2.965 560.7 12.9C577.7 28.76 580.8 54.54 568.2 74.07L406.5 324.1C391.3 347.7 366.6 363.2 339.3 367.1L224 263.3zM320 400C320 461.9 269.9 512 208 512H64C46.33 512 32 497.7 32 480C32 462.3 46.33 448 64 448H68.81C86.44 448 98.4 429.1 96.59 411.6C96.2 407.8 96 403.9 96 400C96 339.6 143.9 290.3 203.7 288.1L319.8 392.5C319.9 394.1 320 397.5 320 400V400z"></svg>Art</a></li></ul></nav><main><section><h1>ERIL</h1>
<h2>Intro</h2>
<p>ERIL is a new programming language project I'm starting. The goal is to rewrite <a href="/projects#lowlang">lowlang</a> so that it
is easier to add new features and to understand how it works. To understand why I'm creating this, let's first take a
look at how memory and datatypes work in programming.</p>
<h2>Memory</h2>
<p>A computer makes use of bits to store data, these can be either 0 or 1. A group of 8 bits is known as a byte. A CPU has
different integer datatypes it can use to do calculations. These are 8 bits, 16 bits, 32 bits and on many modern CPUs
also 64 bits and sometimes even 128 bits. These integer datatypes are usually placed in CPU registers, however there are
only a limited number of these. When all registers are in use any new values are placed on the stack, which can increase
in size to store more values. Values on the stack are always accessed by use of a reference or memory address, whereas
values in registes can be used directly. When generating assembly it is very improtant to take all of this into
account. It is also very important that the datatypes of all values in a program are known before generating assembly,
because the assembly instructions differ for different datatypes.</p>
<h2>Generics</h2>
<p>Because all types need to be known before generating the assembly, many programming languages require the user to enter
the types of variables, function parameters, etc. But what if you want a certain function to work for multiple differnt
types? Each of those different datatypes might be a differnt number of bits, or use different assembly instruction to
work with them. However, the assembly genrated for a function is always the same. The way modern programming languages
solve this problem is by parameterizing the entire function definition by &quot;type parameters&quot;. This feature is also known
as &quot;generics&quot;, as it generalizes the function definition. Turning these generic function into assembly can be done in
two ways, the first being monomorphization. With monomorphization a polymorphic (generic) function is turned into a
monomorphic (non-generic) function for every datatypes it is used with. So if a generic function is used with two
datatypes, one of 16 bits and one of 64 bits, then two copies of that function will be generated, one which works only
for the 16 bit datatypes and one that works only for the 64 bit datatype. This method has the advantage of being very
simple to implement and each of the copied functions can also be optimized individually. The downside is that now the
assembly for a function has to be generated multiple times, which will take more time and also increase the size of the
final binary file. It is also harder for other libraries to make use of these functions since they would have to
generate even more copies for any of their own custom datatypes.</p>
<h2>The solution</h2>
<p>The only other way to have the same code work with multiple datatypes is to only access values of those types indirectly
through pointers or references. This usually means that before passing a value to a generic function it is first placed
on the stack, and the memory address of that values is then passed to the function. This works because pointer values
always use the smae number of bits and use the same assembly instructions. But this only solves half of the problem. Now
the function can receive values of any type, but it can't do anything with them. The way this can be solved is by also
passing in functions that perform operations on the datatypes indirectly. An example: say our generic function wants to
add two values of generic type T. Then two pointers to a value T will have to be pased to the function and a pointer to
a location in memory where the result can be stored, as well as a pointer to a function that can add two values of type
T. In the C programming language that would look something like this:</p>
<pre><code class="language-c">// generic function
void add(T* ret, T* a, T* b, void *add_T(T*, T*, T*)) {
    add_T(ret, a, b);
}

int add_int(int a, int b)
    return a + b;
}

// usage
int a = 3;
int b = 5;
int ret;

add(&amp;ret, &amp;a, &amp;b, add_int);
</code></pre>
<h4>Continue reading</h4>
<ul>
    <li><a href="/eril/memory-layout">Memory Layout</a></li>
</ul>
</section><footer><ul class="left"><li><a href="/">xiulf.com</a></li></ul><ul class="right"><li><a href="https://www.youtube.com/channel/UCfJ4QYLydlqlIeBp5sRdVKA" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></svg></a></li><li><a href="https://www.twitch.tv/fluix__" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M391.17,103.47H352.54v109.7h38.63ZM285,103H246.37V212.75H285ZM120.83,0,24.31,91.42V420.58H140.14V512l96.53-91.42h77.25L487.69,256V0ZM449.07,237.75l-77.22,73.12H294.61l-67.6,64v-64H140.14V36.58H449.07Z"></svg></a></li><li><a href="https://open.spotify.com/user/tttymo16?si=130367a2ada14e55" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M248 8C111.1 8 0 119.1 0 256s111.1 248 248 248 248-111.1 248-248S384.9 8 248 8zm100.7 364.9c-4.2 0-6.8-1.3-10.7-3.6-62.4-37.6-135-39.2-206.7-24.5-3.9 1-9 2.6-11.9 2.6-9.7 0-15.8-7.7-15.8-15.8 0-10.3 6.1-15.2 13.6-16.8 81.9-18.1 165.6-16.5 237 26.2 6.1 3.9 9.7 7.4 9.7 16.5s-7.1 15.4-15.2 15.4zm26.9-65.6c-5.2 0-8.7-2.3-12.3-4.2-62.5-37-155.7-51.9-238.6-29.4-4.8 1.3-7.4 2.6-11.9 2.6-10.7 0-19.4-8.7-19.4-19.4s5.2-17.8 15.5-20.7c27.8-7.8 56.2-13.6 97.8-13.6 64.9 0 127.6 16.1 177 45.5 8.1 4.8 11.3 11 11.3 19.7-.1 10.8-8.5 19.5-19.4 19.5zm31-76.2c-5.2 0-8.4-1.3-12.9-3.9-71.2-42.5-198.5-52.7-280.9-29.7-3.6 1-8.1 2.6-12.9 2.6-13.2 0-23.3-10.3-23.3-23.6 0-13.6 8.4-21.3 17.4-23.9 35.2-10.3 74.6-15.2 117.5-15.2 73 0 149.5 15.2 205.4 47.8 7.8 4.5 12.9 10.7 12.9 22.6 0 13.6-11 23.3-23.2 23.3z"></svg></a></li><li><a href="https://github.com/Cyberduc-k" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></svg></a></li><li><a href="https://discord.gg/kRkSQKmq7n" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M524.531,69.836a1.5,1.5,0,0,0-.764-.7A485.065,485.065,0,0,0,404.081,32.03a1.816,1.816,0,0,0-1.923.91,337.461,337.461,0,0,0-14.9,30.6,447.848,447.848,0,0,0-134.426,0,309.541,309.541,0,0,0-15.135-30.6,1.89,1.89,0,0,0-1.924-.91A483.689,483.689,0,0,0,116.085,69.137a1.712,1.712,0,0,0-.788.676C39.068,183.651,18.186,294.69,28.43,404.354a2.016,2.016,0,0,0,.765,1.375A487.666,487.666,0,0,0,176.02,479.918a1.9,1.9,0,0,0,2.063-.676A348.2,348.2,0,0,0,208.12,430.4a1.86,1.86,0,0,0-1.019-2.588,321.173,321.173,0,0,1-45.868-21.853,1.885,1.885,0,0,1-.185-3.126c3.082-2.309,6.166-4.711,9.109-7.137a1.819,1.819,0,0,1,1.9-.256c96.229,43.917,200.41,43.917,295.5,0a1.812,1.812,0,0,1,1.924.233c2.944,2.426,6.027,4.851,9.132,7.16a1.884,1.884,0,0,1-.162,3.126,301.407,301.407,0,0,1-45.89,21.83,1.875,1.875,0,0,0-1,2.611,391.055,391.055,0,0,0,30.014,48.815,1.864,1.864,0,0,0,2.063.7A486.048,486.048,0,0,0,610.7,405.729a1.882,1.882,0,0,0,.765-1.352C623.729,277.594,590.933,167.465,524.531,69.836ZM222.491,337.58c-28.972,0-52.844-26.587-52.844-59.239S193.056,219.1,222.491,219.1c29.665,0,53.306,26.82,52.843,59.239C275.334,310.993,251.924,337.58,222.491,337.58Zm195.38,0c-28.971,0-52.843-26.587-52.843-59.239S388.437,219.1,417.871,219.1c29.667,0,53.307,26.82,52.844,59.239C470.715,310.993,447.538,337.58,417.871,337.58Z"></svg></a></li><li><a href="mailto:xiulf@outlook.com"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></svg></a></li></ul></footer></main></body></html>
